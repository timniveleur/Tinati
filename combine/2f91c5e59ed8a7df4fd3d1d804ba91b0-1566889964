
$(function(){$.validator.addMethod("regex",function(value,element,regexp){var check=false;return this.optional(element)||regexp.test(value);},"Заполните поле");$('#call-form').validate({rules:{name:"required",tel:{required:true,regex:/^\+7\s\(([0-9]{3})\)\s([0-9]{3})-([0-9]{2})-([0-9]{2})/}},messages:{name:"Заполните поле",tel:{required:"Заполните поле",regex:"Неверно указан номер телефона",},},submitHandler:function(){$.ajax({type:"POST",url:"/newcall",data:{title:$('#call-form input[name="title"]')[0].value,name:$('#call-form input[name="name"]')[0].value,tel:$('#call-form input[name="tel"]')[0].value,time:$('#call-form input[name="time"]')[0].value},dataType:"json",success:function(response){$('#call-form').addClass('d-none');$('.succes-form-call-message').text(response);ingEvents.Event({category:"forms",action:"submit",label:"application",ya_label:"application"});},error:function(response){$.each(response.responseJSON,function(e,value){$('#call-form input[name='+e+']').addClass('error');$('#call-form .'+e+'-error-field').text(value[0]);})}});return false;}});$('#employee-form').validate({rules:{name:"required",tel:{required:true,regex:/^\+7\s\(([0-9]{3})\)\s([0-9]{3})-([0-9]{2})-([0-9]{2})/}},messages:{name:"Заполните поле",tel:{required:"Заполните поле",regex:"Неверно указан номер телефона",},},submitHandler:function(){$.ajax({type:"POST",url:"/newcall",data:{name:$('#employee-form input[name="name"]')[0].value,tel:$('#employee-form input[name="tel"]')[0].value},dataType:"json",success:function(response){$('#employee-form').addClass('d-none');$('.succes-form-call-message').text(response);},error:function(response){$.each(response.responseJSON,function(e,value){$('#employee-form input[name='+e+']').addClass('error');$('#employee-form .'+e+'-error-field').text(value[0]);})}});return false;}});$('#promo-form').validate({rules:{name:"required",tel:{required:true,regex:/^\+7\s\(([0-9]{3})\)\s([0-9]{3})-([0-9]{2})-([0-9]{2})/}},messages:{name:"Заполните поле",tel:{required:"Заполните поле",regex:"Неверно указан номер телефона",},},submitHandler:function(){$.ajax({type:"POST",url:"/newcall",data:{title:$('#promo-form input[name="title"]')[0].value,name:$('#promo-form input[name="name"]')[0].value,tel:$('#promo-form input[name="tel"]')[0].value,day:$($('.h2-loyalty')[0]).text(),},dataType:"json",success:function(response){$('#promo-form').addClass('d-none');$('.succes-form-call-message').text(response);ingEvents.Event({category:"forms",action:"submit",label:"application",ya_label:"application"});},error:function(response){$.each(response.responseJSON,function(e,value){$('#promo-form input[name='+e+']').addClass('error');$('#promo-form .'+e+'-error-field').text(value[0]);})}});return false;}});});$(document).on('click','#call-form-btn',function(e){$('#call-form').submit();});$(document).on('click','#detail-employee-btn',function(){$('#employee-form').submit();})
$(document).on('click','#detail-promo-btn',function(){$('#promo-form').submit();})
$(document).on('click','#footer-form-subscribe-btn',function(e){e.preventDefault();$.ajax({type:"POST",url:"/newsubscribe",data:{title:$('#subscribe input[name="title"]')[0].value,mail:$('#subscribe input[name="email"]')[0].value},dataType:"json",success:function(response){$('#footer-subscribe-alert').removeClass('danger');$('#footer-subscribe-alert').text(response);ingEvents.Event({category:"forms",action:"submit",label:"distribution",ya_label:"distribution"});},error:function(response){$('#footer-subscribe-alert').addClass('danger');if(response.status==403){$('#footer-subscribe-alert').text(response.responseJSON.mail[0]);}else{$('#footer-subscribe-alert').text('Что-то пошло не так');}}});});